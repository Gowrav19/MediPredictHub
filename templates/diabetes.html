<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diabetes Risk Assessment - MediAI</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='modern_style.css') }}">
    
    <!-- AOS Animation -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
</head>
<body>
    <!-- Modern Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top modern-navbar">
        <div class="container">
            <a class="navbar-brand fw-bold" href="{{ url_for('home') }}" data-aos="fade-right">
                <i class="bi bi-heart-pulse me-2"></i>MediAI
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="{{ url_for('home') }}">Home</a></li>
                    <li class="nav-item"><a class="nav-link active" href="{{ url_for('diabetes') }}">Diabetes</a></li>
                    <li class="nav-item"><a class="nav-link" href="{{ url_for('heart') }}">Heart Disease</a></li>
                    <li class="nav-item"><a class="nav-link" href="{{ url_for('cancer') }}">Breast Cancer</a></li>
                    <li class="nav-item"><a class="nav-link" href="{{ url_for('chatbot_page') }}">AI Assistant</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-background"></div>
        <div class="container">
            <div class="row align-items-center min-vh-100">
                <div class="col-lg-6" data-aos="fade-right">
                    <div class="hero-icon mb-4">
                        <i class="bi bi-droplet"></i>
                    </div>
                    <h1 class="hero-title fw-bold mb-4">
                        Diabetes Risk<br>
                        <span class="text-gradient">Assessment</span>
                    </h1>
                    <p class="hero-subtitle mb-5">
                        Get an accurate diabetes risk assessment using advanced machine learning algorithms. 
                        Our system analyzes 8+ health parameters to provide early detection and prevention insights.
                    </p>
                    <div class="hero-stats">
                        <div class="row text-center">
                            <div class="col-4">
                                <div class="stat-number">97%+</div>
                                <div class="stat-label">Accuracy</div>
                            </div>
                            <div class="col-4">
                                <div class="stat-number">8</div>
                                <div class="stat-label">Parameters</div>
                            </div>
                            <div class="col-4">
                                <div class="stat-number">Instant</div>
                                <div class="stat-label">Results</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6" data-aos="fade-left">
                    <div class="hero-visual">
                        <div class="floating-card card-1">
                            <i class="bi bi-graph-up"></i>
                            <span>Glucose Level</span>
                        </div>
                        <div class="floating-card card-2">
                            <i class="bi bi-person"></i>
                            <span>BMI Analysis</span>
                        </div>
                        <div class="floating-card card-3">
                            <i class="bi bi-heart"></i>
                            <span>Blood Pressure</span>
                        </div>
                        <div class="ai-brain">
                            <i class="bi bi-cpu"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Prediction Form Section -->
    <section class="py-5 prediction-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="prediction-form" data-aos="fade-up">
                        <div class="form-header text-center mb-5">
                            <h2 class="form-title">Enter Your Health Information</h2>
                            <p class="form-subtitle">Please provide accurate information for the best prediction results</p>
                        </div>

                        <form id="diabetesForm" class="needs-validation" novalidate>
                            <div class="row g-4">
                                <!-- Pregnancies -->
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="pregnancies" class="form-label">
                                            <i class="bi bi-person me-2"></i>Number of Pregnancies
                                        </label>
                                        <input type="number" class="form-control" id="pregnancies" name="pregnancies" 
                                               min="0" max="17" required>
                                        <div class="form-text">Enter 0 if not applicable</div>
                                        <div class="invalid-feedback">Please enter a valid number of pregnancies (0-17)</div>
                                    </div>
                                </div>

                                <!-- Glucose Level -->
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="glucose" class="form-label">
                                            <i class="bi bi-droplet me-2"></i>Glucose Level (mg/dL)
                                        </label>
                                        <input type="number" class="form-control" id="glucose" name="glucose" 
                                               min="50" max="200" required>
                                        <div class="form-text">Normal range: 70-99 mg/dL</div>
                                        <div class="invalid-feedback">Please enter a valid glucose level (50-200)</div>
                                    </div>
                                </div>

                                <!-- Blood Pressure -->
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="blood_pressure" class="form-label">
                                            <i class="bi bi-heart me-2"></i>Blood Pressure (mm Hg)
                                        </label>
                                        <input type="number" class="form-control" id="blood_pressure" name="blood_pressure" 
                                               min="30" max="130" required>
                                        <div class="form-text">Diastolic blood pressure</div>
                                        <div class="invalid-feedback">Please enter a valid blood pressure (30-130)</div>
                                    </div>
                                </div>

                                <!-- Skin Thickness -->
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="skin_thickness" class="form-label">
                                            <i class="bi bi-rulers me-2"></i>Skin Thickness (mm)
                                        </label>
                                        <input type="number" class="form-control" id="skin_thickness" name="skin_thickness" 
                                               min="0" max="99" required>
                                        <div class="form-text">Triceps skin fold thickness</div>
                                        <div class="invalid-feedback">Please enter a valid skin thickness (0-99)</div>
                                    </div>
                                </div>

                                <!-- Insulin -->
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="insulin" class="form-label">
                                            <i class="bi bi-activity me-2"></i>Insulin Level (mu U/ml)
                                        </label>
                                        <input type="number" class="form-control" id="insulin" name="insulin" 
                                               min="0" max="850" required>
                                        <div class="form-text">2-hour serum insulin</div>
                                        <div class="invalid-feedback">Please enter a valid insulin level (0-850)</div>
                                    </div>
                                </div>

                                <!-- BMI -->
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="bmi" class="form-label">
                                            <i class="bi bi-speedometer me-2"></i>BMI (kg/m²)
                                        </label>
                                        <input type="number" class="form-control" id="bmi" name="bmi" 
                                               min="10" max="70" step="0.1" required>
                                        <div class="form-text">Body Mass Index</div>
                                        <div class="invalid-feedback">Please enter a valid BMI (10-70)</div>
                                    </div>
                                </div>

                                <!-- Diabetes Pedigree Function -->
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="diabetes_pedigree_function" class="form-label">
                                            <i class="bi bi-diagram-3 me-2"></i>Diabetes Pedigree Function
                                        </label>
                                        <input type="number" class="form-control" id="diabetes_pedigree_function" name="diabetes_pedigree_function" 
                                               min="0.08" max="2.50" step="0.01" required>
                                        <div class="form-text">Family diabetes history impact</div>
                                        <div class="invalid-feedback">Please enter a valid value (0.08-2.50)</div>
                                    </div>
                                </div>

                                <!-- Age -->
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label for="age" class="form-label">
                                            <i class="bi bi-calendar me-2"></i>Age (years)
                                        </label>
                                        <input type="number" class="form-control" id="age" name="age" 
                                               min="21" max="81" required>
                                        <div class="form-text">Your current age</div>
                                        <div class="invalid-feedback">Please enter a valid age (21-81)</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions text-center mt-5">
                                <button type="submit" class="btn btn-primary btn-lg me-3" id="predictBtn">
                                    <i class="bi bi-play-circle me-2"></i>Get Prediction
                                </button>
                                <button type="reset" class="btn btn-outline-light btn-lg">
                                    <i class="bi bi-arrow-clockwise me-2"></i>Reset Form
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Results Section -->
    <section id="results" class="py-5 results-section" style="display: none;">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="results-card" data-aos="fade-up">
                        <div class="results-header text-center mb-4">
                            <h3 class="results-title">Prediction Results</h3>
                        </div>
                        <div class="results-content">
                            <div class="prediction-result text-center mb-4">
                                <div class="result-icon">
                                    <i class="bi bi-check-circle" id="resultIcon"></i>
                                </div>
                                <h4 class="result-text" id="resultText"></h4>
                                <div class="confidence-score" id="confidenceScore"></div>
                            </div>
                            <div class="risk-analysis" id="riskAnalysis"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Information Section -->
    <section class="py-5 info-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-6" data-aos="fade-right">
                    <h3 class="info-title">Understanding Diabetes Risk</h3>
                    <p class="info-text">
                        Diabetes is a chronic condition that affects how your body processes glucose. 
                        Early detection and management can prevent serious complications.
                    </p>
                    <div class="info-features">
                        <div class="feature-item">
                            <i class="bi bi-check-circle"></i>
                            <span>Type 1 Diabetes: Autoimmune condition</span>
                        </div>
                        <div class="feature-item">
                            <i class="bi bi-check-circle"></i>
                            <span>Type 2 Diabetes: Insulin resistance</span>
                        </div>
                        <div class="feature-item">
                            <i class="bi bi-check-circle"></i>
                            <span>Gestational Diabetes: During pregnancy</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6" data-aos="fade-left">
                    <h3 class="info-title">Risk Factors</h3>
                    <ul class="risk-factors">
                        <li>Family history of diabetes</li>
                        <li>Being overweight or obese</li>
                        <li>Age 45 or older</li>
                        <li>Physical inactivity</li>
                        <li>High blood pressure</li>
                        <li>Abnormal cholesterol levels</li>
                        <li>History of gestational diabetes</li>
                        <li>Polycystic ovary syndrome (PCOS)</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- AOS Animation -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- Custom JavaScript -->
    <script>
        // Initialize AOS
        AOS.init({
            duration: 1000,
            once: true,
            offset: 100
        });

        // Form validation
        (function() {
            'use strict';
            window.addEventListener('load', function() {
                var forms = document.getElementsByClassName('needs-validation');
                var validation = Array.prototype.filter.call(forms, function(form) {
                    form.addEventListener('submit', function(event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                        } else {
                            event.preventDefault();
                            handleFormSubmission();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);
        })();

        // Handle form submission
        function handleFormSubmission() {
            const form = document.getElementById('diabetesForm');
            const predictBtn = document.getElementById('predictBtn');
            
            // Collect form data
            const formData = {
                pregnancies: parseFloat(document.getElementById('pregnancies').value) || 0,
                glucose: parseFloat(document.getElementById('glucose').value) || 0,
                blood_pressure: parseFloat(document.getElementById('blood_pressure').value) || 0,
                skin_thickness: parseFloat(document.getElementById('skin_thickness').value) || 0,
                insulin: parseFloat(document.getElementById('insulin').value) || 0,
                bmi: parseFloat(document.getElementById('bmi').value) || 0,
                diabetes_pedigree: parseFloat(document.getElementById('diabetes_pedigree_function').value) || 0,
                age: parseFloat(document.getElementById('age').value) || 0
            };
            
            // Show loading state
            predictBtn.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>Analyzing...';
            predictBtn.disabled = true;
            
            // Send prediction request
            fetch('/predict_diabetes', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    displayResults(data);
                } else {
                    showError(data.error || 'An error occurred');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showError('Network error. Please try again.');
            })
            .finally(() => {
                // Reset button
                predictBtn.innerHTML = '<i class="bi bi-play-circle me-2"></i>Get Prediction';
                predictBtn.disabled = false;
            });
        }

        // Display results
        function displayResults(data) {
            const resultsSection = document.getElementById('results');
            const resultText = document.getElementById('resultText');
            const resultIcon = document.getElementById('resultIcon');
            const confidenceScore = document.getElementById('confidenceScore');
            const riskAnalysis = document.getElementById('riskAnalysis');
            
            // Update result text
            resultText.textContent = data.prediction;
            confidenceScore.textContent = `Confidence: ${data.confidence.toFixed(1)}%`;
            
            // Update icon and styling based on prediction
            if (data.prediction === 'Diabetic') {
                resultIcon.className = 'bi bi-exclamation-triangle';
                resultIcon.parentElement.className = 'result-icon high-risk';
                resultText.className = 'result-text high-risk';
            } else {
                resultIcon.className = 'bi bi-check-circle';
                resultIcon.parentElement.className = 'result-icon low-risk';
                resultText.className = 'result-text low-risk';
            }
            
            // Generate risk analysis
            generateRiskAnalysis(data, riskAnalysis);
            
            // Show results section
            resultsSection.style.display = 'block';
            resultsSection.scrollIntoView({ behavior: 'smooth' });
        }

        // Generate risk analysis
        function generateRiskAnalysis(data, container) {
            const isDiabetic = data.prediction === 'Diabetic';
            const confidence = data.confidence;
            
            let analysisHTML = '';
            
            if (isDiabetic) {
                analysisHTML = `
                    <div class="risk-analysis-content high-risk">
                        <h5><i class="bi bi-exclamation-triangle me-2"></i>High Risk Detected</h5>
                        <p>Your health indicators suggest an elevated risk of diabetes. Please consult with a healthcare professional immediately.</p>
                        <div class="recommendations">
                            <h6>Immediate Actions:</h6>
                            <ul>
                                <li>Schedule an appointment with your doctor</li>
                                <li>Get comprehensive blood tests (HbA1c, fasting glucose)</li>
                                <li>Consider meeting with a nutritionist</li>
                                <li>Start a structured exercise program</li>
                                <li>Monitor blood glucose regularly</li>
                            </ul>
                        </div>
                    </div>
                `;
            } else {
                analysisHTML = `
                    <div class="risk-analysis-content low-risk">
                        <h5><i class="bi bi-check-circle me-2"></i>Low Risk</h5>
                        <p>Your current health indicators suggest a low risk of diabetes. Continue maintaining your healthy lifestyle.</p>
                        <div class="recommendations">
                            <h6>Prevention Tips:</h6>
                            <ul>
                                <li>Maintain regular physical activity</li>
                                <li>Follow a balanced, nutritious diet</li>
                                <li>Keep your weight in the healthy BMI range</li>
                                <li>Get regular health check-ups</li>
                                <li>Monitor blood pressure and cholesterol</li>
                            </ul>
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = analysisHTML;
        }

        // Show error message
        function showError(message) {
            alert('Error: ' + message);
        }

        // Navbar scroll effect
        window.addEventListener('scroll', function() {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) {
                navbar.classList.add('navbar-scrolled');
            } else {
                navbar.classList.remove('navbar-scrolled');
            }
        });
    </script>

    <style>
        /* Additional styles for the diabetes page */
        .hero-icon {
            font-size: 4rem;
            color: var(--accent-color);
        }

        .prediction-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
        }

        .prediction-form {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            padding: 3rem;
            box-shadow: var(--shadow-light);
        }

        .form-title {
            font-size: 2rem;
            font-weight: 700;
            color: white;
            margin-bottom: 1rem;
        }

        .form-subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            color: white;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .form-control {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-border);
            color: white;
            border-radius: 10px;
            padding: 0.75rem 1rem;
        }

        .form-control:focus {
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--accent-color);
            box-shadow: 0 0 0 0.2rem rgba(240, 147, 251, 0.25);
            color: white;
        }

        .form-control::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .form-text {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .results-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
        }

        .results-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            padding: 3rem;
            box-shadow: var(--shadow-light);
        }

        .results-title {
            font-size: 2rem;
            font-weight: 700;
            color: white;
        }

        .result-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .result-icon.low-risk {
            color: var(--success-color);
        }

        .result-icon.high-risk {
            color: var(--danger-color);
        }

        .result-text {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .result-text.low-risk {
            color: var(--success-color);
        }

        .result-text.high-risk {
            color: var(--danger-color);
        }

        .confidence-score {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 2rem;
        }

        .risk-analysis-content {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            padding: 2rem;
        }

        .risk-analysis-content h5 {
            color: white;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .risk-analysis-content h6 {
            color: white;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .risk-analysis-content p {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 1.5rem;
        }

        .risk-analysis-content ul {
            color: rgba(255, 255, 255, 0.8);
            padding-left: 1.5rem;
        }

        .risk-analysis-content li {
            margin-bottom: 0.5rem;
        }

        .info-section {
            background: var(--gradient-primary);
            color: white;
        }

        .info-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
        }

        .info-text {
            font-size: 1.1rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .info-features {
            margin-bottom: 2rem;
        }

        .feature-item {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .feature-item i {
            color: var(--accent-color);
            margin-right: 1rem;
            font-size: 1.2rem;
        }

        .risk-factors {
            list-style: none;
            padding: 0;
        }

        .risk-factors li {
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .risk-factors li:before {
            content: "•";
            color: var(--accent-color);
            font-weight: bold;
            display: inline-block;
            width: 1em;
            margin-left: -1em;
        }
    </style>
</body>
</html>